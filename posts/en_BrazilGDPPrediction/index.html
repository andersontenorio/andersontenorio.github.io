<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Using Data Science to Predict the Brazilian GDP | Anderson Tenório</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Using Data Science to Predict the Brazilian GDP" /><meta name="author" content="Anderson Tenório Sergio" /><meta property="og:locale" content="en_US" /><meta name="description" content="(Você pode ler esse post em português)" /><meta property="og:description" content="(Você pode ler esse post em português)" /><link rel="canonical" href="https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/" /><meta property="og:url" content="https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/" /><meta property="og:site_name" content="Anderson Tenório" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-19T15:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Using Data Science to Predict the Brazilian GDP" /><meta name="twitter:site" content="@andersontenorio" /><meta name="twitter:creator" content="@Anderson Tenório Sergio" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"(Você pode ler esse post em português)","mainEntityOfPage":{"@type":"WebPage","@id":"https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/"},"@type":"BlogPosting","author":{"@type":"Person","name":"Anderson Tenório Sergio"},"url":"https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/","headline":"Using Data Science to Predict the Brazilian GDP","dateModified":"2021-01-19T15:00:00-03:00","datePublished":"2021-01-19T15:00:00-03:00","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Anderson Tenório</a></div><div class="site-subtitle font-italic">Geek, sports and stuff.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/personal/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-personal ml-xl-3 mr-xl-3 unloaded"></i> <span>PERSONAL</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/academic/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-academic ml-xl-3 mr-xl-3 unloaded"></i> <span>ACADEMIC</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/professional/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-professional ml-xl-3 mr-xl-3 unloaded"></i> <span>PROFESSIONAL</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/andersontenorio" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/andersontenorio" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['anderson.sergio','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Using Data Science to Predict the Brazilian GDP</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Using Data Science to Predict the Brazilian GDP</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 19, 2021, 3:00 PM -0300" > Jan 19 <i class="unloaded">2021-01-19T15:00:00-03:00</i> </span> by <span class="author"> Anderson Tenório Sergio </span></div></div><div class="post-content"><p>(Você pode ler esse post em <a href="https://medium.com/@atenorios/previs%C3%A3o-do-pib-brasileiro-com-data-science-cd4da3025c45">português</a>)</p><p>GDP (Gross Domestic Product) is a measure that represents the sum in monetary values of all final goods and services produced in a given region [1]. In Brazil, the value is normally released every quarter of the year. Next, I will present a methodology for forecasting the GDP value for the next quarter using Data Science techniques. The task can be viewed as a time series forecasting problem. To organize the reasoning, I will follow the steps of the KDD process (Knowledge Discovery in Databases) [2]. The code was built in Python, using the most widespread libraries of this language in data science (pandas, numpy, scikit-learn).</p><h2 id="selection">Selection</h2><p>The original data was extracted from IBGE (Portuguese acronym for the Brazilian Institute of Geography and Statistics) [3]. The database contains the historical series of the GDP variation per semester, from the beginning of 1996 to the end of 2019. The extraction was done by downloading a file in CSV format. The study used data from the last 24 years for this period to represent a more stable range of variation in Brazilian GDP, coinciding with the stabilization of the current currency, in 1994. The prediction of future values for a time series achieves results closer to reality when current patterns do not differ substantially from historical values. Using older data makes certain distortions possible. Below, a figure of the referred data source with the time series plot.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/posts/pib1.png" alt="" /> <em>Fig. 1 - GDP variation quartely variation (1996 to 2019)</em></p><h2 id="preprocessing">Preprocessing</h2><p>Since we have a one-dimensional time series without missing data, it was not necessary to perform pre-processing operations. However, I will include in this section the analysis of the autocorrelation function (ACF). Autocorrelation refers to the correlation of a signal with its delayed values [4]. In other words, the analysis of this behavior allows us to understand how many past values of a time series influence the future values. The following image shows the autocorrelation function plot for the studied time series.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/posts/pib2.png" alt="" /><br /> <em>Fig. 2 - Time series autocorrelation function</em></p><p>This chart tells us how many past values significantly impact each point in the series. We can extract this information by looking at how many peaks are placed outside the central cone (painted in blue). Thus, we can conclude that, in general, it will be possible to predict the future values of the series by observing at least the four immediately previous values. Besides, the almost regular variation between the positive and negative peaks indicates a short seasonality in the series.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s">'20200310012841.csv'</span>
<span class="n">df_timeseries</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df_timeseries</span><span class="p">[</span><span class="s">'gdp'</span><span class="p">])</span>
</pre></table></code></div></div><h2 id="transformation">Transformation</h2><p>To predict time series in a standard machine learning modeling, the database must be in a matrix format: a set of n input vectors, usually multidimensional. Thus, a certain amount of delayed values may be used to create each of the input vectors. Consider, for example, a time series formed by the integers 4, 7, 5, 8, 10, 1, 0, 8, 3, 4, 2, 6. To transform this series into a dataset for supervised learning, we define the number of lags and build the n vectors labeled with the expected values. For example, with lags = 4, the previous time series becomes the following dataset (desired values in italic):</p><p>4, 7, 5, 8, <em>10</em><br /> 7, 5, 8, 10, <em>1</em><br /> 5, 8, 10, 1, <em>0</em><br /> 8, 10, 1, 0, <em>8</em><br /> 10, 1, 0, 8, <em>3</em><br /> 1, 0, 8, 3, <em>4</em><br /> 0, 8, 3, 4, <em>2</em><br /> 8, 3, 4, 2, <em>6</em></p><p>How many lagged values should we use? The plot of the autocorrelation function can give us a direction. In the quarterly GDP problem, we noted earlier that 4 is the number of past values that significantly influence the points in the series. This amount can be used as a starting point. Sometimes more detailed experimentation or study of the data is necessary to reach the optimal value. In a process driven by trial and error, I realized that running a few experiments that 8 is a good option. In this case, I am using the GDP variations of the last 8 quarters (two years) to forecast the value for the next quarter.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s">'t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_timeseries</span><span class="p">[</span><span class="s">'gdp'</span><span class="p">]</span>
<span class="n">lags</span> <span class="o">=</span> <span class="mi">8</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lags</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>    
    <span class="n">df</span><span class="p">[</span><span class="s">'t-'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'t'</span><span class="p">].</span><span class="n">shift</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">lags</span><span class="p">:]</span>
</pre></table></code></div></div><h2 id="data-mining">Data Mining</h2><p>In the data mining step, the goal is to use some model or algorithm of statistics or machine learning to obtain predictions. In this study, the model used was the well known linear regression. As usual, the dataset was partitioned between training (60%) and testing (40%). The determination coefficient (R2) in the test database was 96%. This metric is the proportion of the variance of the target variable that is explained by the input variables (the lagged values) [5]. Considering that its maximum value is 100%, the achieved results seem adequate. For a graphical analysis of the predictions, the figures below show the dispersion plots (blue for training and orange for testing) and the comparison between real (blue) and predicted (orange) values in the training and test datasets, respectively.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/posts/pib3.png" alt="" /><br /> <em>Fig. 3 - Dispersion plot between expected and predicted values</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/posts/pib4.png" alt="" /> <em>Fig. 4 - Expected (blue) and predicted (orange) values in the training dataset</em></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../../assets/img/posts/pib5.png" alt="" /> <em>Fig. 5 - Expected (blue) and predicted (orange) values in the test dataset</em></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">regr</span> <span class="o">=</span> <span class="n">linear_model</span><span class="p">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">regr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">regr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">regr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Coefficients: </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">regr</span><span class="p">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean squared error (TRAIN): %.2f'</span> <span class="o">%</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean absolute error (TRAIN): %.2f'</span> <span class="o">%</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Coefficient of determination (TRAIN): %.2f'</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean squared error (TEST): %.2f'</span> <span class="o">%</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Mean absolute error (TEST): %.2f'</span> <span class="o">%</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Coefficient of determination (TEST): %.2f'</span> <span class="o">%</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_train</span><span class="p">.</span><span class="n">to_numpy</span><span class="p">())</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_train</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">to_numpy</span><span class="p">())</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="interpretation">Interpretation</h2><p>Through the presented methodology and the analysis of the achieved results, it is possible to conclude that the linear regression from lagged values is a good model for forecasting the quarterly variation of the Brazilian GDP. Thus, if the behavior of the time series does not vary substantially concerning its history, it is feasible to anticipate the variation of the quarterly GDP with some advance. Two points deserve discussion:</p><ul><li><p>It is necessary to discuss with experts in the field if this type of forecast is useful in a practical way. The forecast horizon may need to be changed. In this case, the model could predict the change in GDP over the next six months or even the next year. Several approaches can be taken to achieve this. Perhaps some of them should be discussed in future publications.</p></li><li><p>It should be noted that the studied time series in this article is hugely influenced by exogenous variables (variables external to the series, such as economic indices, world market behavior, epidemics, etc.). A more reliable model must take at least some of these variables into account. However, the methodology presented here represents a didactic starting point for further analysis.</p></li></ul><p>Source code: <a href="https://github.com/andersontenorio/brazilgdpforecasting">https://github.com/andersontenorio/brazilgdpforecasting</a></p><h2 id="references">REFERENCES</h2><p>[1] <a href="https://en.wikipedia.org/wiki/Gross_domestic_product">https://en.wikipedia.org/wiki/Gross_domestic_product</a></p><p>[2] <a href="/posts/en_ProcessesDataScience">Processes in Data Science</a></p><p>[3] <a href="https://www.ibge.gov.br/estatisticas/economicas/contas-nacionais/9300-contas-nacionais-trimestrais.html">https://www.ibge.gov.br/estatisticas/economicas/contas-nacionais/9300-contas-nacionais-trimestrais.html (Portuguese)</a></p><p>[4] <a href="https://en.wikipedia.org/wiki/Autocorrelation">https://en.wikipedia.org/wiki/Autocorrelation</a></p><p>[5] <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">https://en.wikipedia.org/wiki/Coefficient_of_determination</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/computer-science/'>Computer Science</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine learning</a> <a href="/tags/data-science/" class="post-tag no-text-decoration" >data science</a> <a href="/tags/analytics/" class="post-tag no-text-decoration" >analytics</a> <a href="/tags/artificial-intelligence/" class="post-tag no-text-decoration" >artificial intelligence</a> <a href="/tags/time-series/" class="post-tag no-text-decoration" >time series</a> <a href="/tags/english/" class="post-tag no-text-decoration" >english</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using Data Science to Predict the Brazilian GDP - Anderson Tenório&url=https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using Data Science to Predict the Brazilian GDP - Anderson Tenório&u=https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Using Data Science to Predict the Brazilian GDP - Anderson Tenório&url=https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/en_IAStateOfArt/">How to keep informed about the State of Art of Artificial Intelligence and Data Science</a></li><li><a href="/posts/pt_EstadoDaArteIA/">Como ficar informado sobre o Estado da Arte em Inteligência Artificial e Data Science</a></li><li><a href="/posts/pt_ProcessosCienciaDados/">Processos em Ciência dos Dados</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/artificial-intelligence/">artificial intelligence</a> <a class="post-tag" href="/tags/analytics/">analytics</a> <a class="post-tag" href="/tags/english/">english</a> <a class="post-tag" href="/tags/portugu%C3%AAs/">português</a> <a class="post-tag" href="/tags/time-series/">time series</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/en_ProcessesDataScience/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 13, 2020 <i class="unloaded">2020-09-13T22:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Processes in Data Science</h3><div class="text-muted small"><p> (Você pode ler esse post em português) In Data Science, which process should one use? From one or more data sources, how can one extract hidden patterns and build predictive models? Despite the Da...</p></div></div></a></div><div class="card"> <a href="/posts/en_IAStateOfArt/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 15, 2020 <i class="unloaded">2020-09-15T18:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to keep informed about the State of Art of Artificial Intelligence and Data Science</h3><div class="text-muted small"><p> (Você pode ler esse post em português) According to Wikipedia, the State of the Art refers to “to the highest level of general development, as of a device, technique, or scientific field achieved ...</p></div></div></a></div><div class="card"> <a href="/posts/pt_ProcessosCienciaDados/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 12, 2020 <i class="unloaded">2020-09-12T12:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Processos em Ciência dos Dados</h3><div class="text-muted small"><p> (You can read this post in english) Em Ciência dos Dados, qual processo podemos utilizar? Como, a partir de uma ou mais fontes de dados, podemos extrair padrões escondidos e construir modelos pred...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/en_IAStateOfArt/" class="btn btn-outline-primary"><p>How to keep informed about the State of Art of Artificial Intelligence and Data Science</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//andersontenorio.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://andersontenorio.github.io/posts/en_BrazilGDPPrediction/'; this.page.identifier = '/posts/en_BrazilGDPPrediction/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/andersontenorio">Anderson Tenório Sergio</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/artificial-intelligence/">artificial intelligence</a> <a class="post-tag" href="/tags/analytics/">analytics</a> <a class="post-tag" href="/tags/english/">english</a> <a class="post-tag" href="/tags/portugu%C3%AAs/">português</a> <a class="post-tag" href="/tags/time-series/">time series</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-177830507-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://andersontenorio.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
